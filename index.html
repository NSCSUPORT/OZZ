<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HoloFi</title>
    <link rel="icon" href="https://nscsuport.github.io/OZZ/z.png" type="image/x-icon">
    <style>
        /* Styles omitidos para brevidade, você pode manter os estilos anteriores */
    </style>
</head>
<body>
    <h1>Pagamento Mercado Pago - HoloFi</h1>
    <div class="container">
        <!-- Campos de entrada -->
        <div class="form-group">
            <label for="investment-value">Valor do Investimento (R$)</label>
            <input type="number" id="investment-value" placeholder="Digite o valor investido" min="1" step="0.01" required>
        </div>

        <div class="form-group">
            <label for="profit">Lucro Esperado (%)</label>
            <input type="number" id="profit" placeholder="Digite o lucro em %" min="1" max="1000" value="100" required>
        </div>

        <div class="form-group">
            <label for="giminiosidade">Giminiosidade (%)</label>
            <input type="number" id="giminiosidade" placeholder="Digite a giminiosidade em %" min="1" max="10000" value="1" required>
        </div>

        <div class="form-group">
            <label for="pix-key">Chave PIX de Cobrança</label>
            <input type="text" id="pix-key" placeholder="Insira a chave PIX" required>
        </div>

        <div class="buttons-group">
            <button class="btn-green" id="generate-code-btn">Gerar Código Mercado Pago</button>
            <button class="btn-red" id="confirm-btn">Confirmar Compra</button>
        </div>

        <div class="qr-code-container" id="qrcode-container">
            <p>Gerando Código...</p>
        </div>

        <footer>
            <p>© 2025 HoloFi | Todos os direitos reservados.</p>
        </footer>
    </div>

    <!-- Mercado Pago SDK -->
    <script src="https://secure.mlstatic.com/sdk/javascript/v1/mercadopago.js"></script>

<script>
    // Inicializa o Mercado Pago com o seu access token
    const accessToken = 'APP_USR-5426605333181809-010315-b06229d80c1e63ed582dbd28e27c677a-1658720398';  // Substitua com seu Access Token do Mercado Pago
    MercadoPago.configurations.setAccessToken(accessToken);

    // Função para criar a preferência de pagamento no Mercado Pago
    function createPaymentPreference(value, profit, giminiosidade) {
        const calculatedProfit = value * (profit / 100);  // Cálculo do lucro
        const totalAmount = value + calculatedProfit;  // Total após lucro
        const geminiAdjustment = (totalAmount * giminiosidade) / 100;
        const adjustedAmount = totalAmount + geminiAdjustment;

        // Define os dados para a preferência de pagamento
        const preference = {
            items: [
                {
                    title: "Investimento HoloFi",
                    quantity: 1,
                    unit_price: adjustedAmount,  // Valor total com ajuste
                }
            ],
            back_urls: {
                success: "https://nscsuport.github.io/OZZ/success",  // URL de sucesso
                failure: "https://nscsuport.github.io/OZZ/failure",  // URL de falha
                pending: "https://nscsuport.github.io/OZZ/pending"   // URL de pendência
            },
            notification_url: "https://www.seusite.com/notification",  // URL para notificação de pagamento
        };

        // Cria a preferência de pagamento
        MercadoPago.preferences.create(preference)
            .then(function(response) {
                const preferenceId = response.response.id;
                // Gerar URL de pagamento
                const paymentLink = response.response.init_point;
                document.getElementById('qrcode-container').innerHTML = `
                    <p>Valor Investido: R$ ${value.toFixed(2)}</p>
                    <p>Lucro Estimado: R$ ${calculatedProfit.toFixed(2)}</p>
                    <p>Total a Pagar (Ajustado): R$ ${adjustedAmount.toFixed(2)}</p>
                    <p><a href="${paymentLink}" target="_blank">Clique aqui para pagar via Mercado Pago</a></p>
                    <p>Ou escaneie o QR Code abaixo:</p>
                    <img src="https://chart.googleapis.com/chart?chs=200x200&cht=qr&chl=${encodeURIComponent(paymentLink)}" alt="QR Code Mercado Pago">
                `;
            }).catch(function(error) {
                alert("Erro ao criar a preferência de pagamento: " + error);
            });
    }

    // Evento para gerar o código de pagamento
    document.getElementById('generate-code-btn').addEventListener('click', function() {
        const value = parseFloat(document.getElementById('investment-value').value);
        const profit = parseFloat(document.getElementById('profit').value);
        const giminiosidadePercentage = parseFloat(document.getElementById('giminiosidade').value);

        if (!value || !profit || !giminiosidadePercentage) {
            alert("Por favor, preencha todos os campos.");
            return;
        }

        // Criar a preferência de pagamento
        createPaymentPreference(value, profit, giminiosidadePercentage);
    });

    // Evento para confirmar o pagamento
    document.getElementById('confirm-btn').addEventListener('click', function() {
        alert("A confirmação de pagamento está pendente. Por favor, finalize seu pagamento via Mercado Pago.");
    });
</script>
</body>
</html>
